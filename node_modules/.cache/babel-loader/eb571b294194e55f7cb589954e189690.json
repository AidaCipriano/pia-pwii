{"ast":null,"code":"var _jsxFileName = \"A:\\\\Users\\\\cesar\\\\Downloads\\\\POI_Tims\\\\POI-PROYECTOFINAL\\\\POI-PROYECTOFINAL\\\\src\\\\Components\\\\GroupButton.jsx\",\n    _s = $RefreshSig$();\n\nimport Navigation from '../Components/NavigationLayout';\nimport Badge from 'react-bootstrap/Badge';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport Card from 'react-bootstrap/Card';\nimport Stack from 'react-bootstrap/Stack';\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport { Container } from 'react-bootstrap';\nimport { collection, query, where, getDocs, serverTimestamp, onSnapshot, doc, updateDoc, Timestamp } from \"firebase/firestore\";\nimport Search from '../Components/Search';\nimport { db, storage } from '../firebase';\nimport { arrayUnion, arrayRemove } from \"firebase/firestore\";\nimport { getDownloadURL, ref, uploadBytesResumable } from \"firebase/storage\";\nimport { useRef } from 'react';\nimport { Firestore, setDoc } from \"firebase/firestore\"; //Bootstrap\n\nimport InputGroup from 'react-bootstrap/InputGroup';\nimport { useContext } from 'react';\nimport { ChatConext } from '../Context/ChatContext';\nimport { useState } from 'react';\nimport { useEffect } from 'react';\nimport { v4 as uuid } from \"uuid\";\nimport { AuthConext } from '../Context/AuthContext';\nimport Image from 'react-bootstrap/Image';\nimport React from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport { useNavigate, Link } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst GroupButton = () => {\n  _s();\n\n  const navigate = useNavigate();\n  const [show, setShow] = useState(false);\n\n  const handleClose = () => setShow(false);\n\n  const handleShow = () => setShow(true);\n\n  const [displayName, setName] = useState(\"\");\n  const [img, setImg] = useState(null);\n  const [err, setErr] = React.useState(false);\n\n  const sendGroup = async () => {\n    try {\n      //Create a unique image name\n      const date = new Date().getTime();\n      const storageRef = ref(storage, `${displayName + date}`);\n      await uploadBytesResumable(storageRef, img).then(() => {\n        getDownloadURL(storageRef).then(async downloadURL => {\n          try {\n            //create user on firestore\n            await setDoc(doc(db, \"users\", displayName), {\n              uid: uuid(),\n              displayName,\n              photoURL: downloadURL\n            });\n            await setDoc(doc(db, \"userChats\", displayName), {});\n            await setDoc(doc(db, \"chats\", displayName), {\n              messages: []\n            });\n            navigate(\"/chats\");\n          } catch (err) {\n            console.log(err);\n            setErr(true);\n          }\n        });\n      });\n    } catch (err) {\n      setErr(true);\n      console.log(err);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      variant: \"danger\",\n      onClick: handleShow,\n      size: \"lg\",\n      children: \"Nuevo chat grupal\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      show: show,\n      onHide: handleClose,\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        closeButton: true,\n        className: \"bn39\",\n        children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n          children: \"A\\xF1adir nuevo chat de grupo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n        children: /*#__PURE__*/_jsxDEV(Form, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n            className: \"mb-3\",\n            controlId: \"formBasicEmail\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Nombre del grupo:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n              type: \"text\",\n              placeholder: \"Grupo #1...\",\n              onChange: e => setName(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 90,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form.Text, {\n              className: \"text-muted\",\n              children: \"Los usuarios tendr\\xE1n que buscar el nombre del grupo en el campo de texto para ingresar a \\xE9l.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            className: \"mb-3\",\n            controlId: \"formBasicPassword\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Foto del grupo:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n              type: \"file\",\n              onChange: e => setImg(e.target.files[0])\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"danger\",\n            onClick: sendGroup,\n            children: \"Crear grupo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\n_s(GroupButton, \"2eO6N33Hk082pqz524Nl7AgaMPQ=\", false, function () {\n  return [useNavigate];\n});\n\n_c = GroupButton;\nexport default GroupButton;\n\nvar _c;\n\n$RefreshReg$(_c, \"GroupButton\");","map":{"version":3,"names":["Navigation","Badge","ListGroup","Card","Stack","Button","Form","Container","collection","query","where","getDocs","serverTimestamp","onSnapshot","doc","updateDoc","Timestamp","Search","db","storage","arrayUnion","arrayRemove","getDownloadURL","ref","uploadBytesResumable","useRef","Firestore","setDoc","InputGroup","useContext","ChatConext","useState","useEffect","v4","uuid","AuthConext","Image","React","Modal","useNavigate","Link","GroupButton","navigate","show","setShow","handleClose","handleShow","displayName","setName","img","setImg","err","setErr","sendGroup","date","Date","getTime","storageRef","then","downloadURL","uid","photoURL","messages","console","log","e","target","value","files"],"sources":["A:/Users/cesar/Downloads/POI_Tims/POI-PROYECTOFINAL/POI-PROYECTOFINAL/src/Components/GroupButton.jsx"],"sourcesContent":["import Navigation from '../Components/NavigationLayout';\nimport Badge from 'react-bootstrap/Badge';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport Card from 'react-bootstrap/Card';\nimport Stack from 'react-bootstrap/Stack';\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport { Container } from 'react-bootstrap';\nimport { collection, query, where, getDocs, serverTimestamp, onSnapshot, doc, updateDoc, Timestamp } from \"firebase/firestore\";\nimport Search from '../Components/Search';\nimport { db, storage } from '../firebase';\nimport { arrayUnion, arrayRemove } from \"firebase/firestore\";\nimport { getDownloadURL, ref, uploadBytesResumable } from \"firebase/storage\";\nimport { useRef } from 'react';\nimport {  Firestore, setDoc } from \"firebase/firestore\";\n\n//Bootstrap\nimport InputGroup from 'react-bootstrap/InputGroup';\nimport { useContext } from 'react';\nimport { ChatConext } from '../Context/ChatContext';\nimport { useState } from 'react';\nimport { useEffect } from 'react';\nimport { v4 as uuid } from \"uuid\";\nimport { AuthConext } from '../Context/AuthContext';\nimport Image from 'react-bootstrap/Image'\nimport React from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport { useNavigate, Link } from \"react-router-dom\";\n\nconst GroupButton = () => {\n    const navigate = useNavigate();\n    const [show, setShow] = useState(false);\n\n    const handleClose = () => setShow(false);\n    const handleShow = () => setShow(true);\n\n    const [displayName, setName] = useState(\"\");\n    const [img, setImg] = useState(null);\n    const [err, setErr] = React.useState(false);\n\n    const sendGroup = async ()=>{\n        try {\n            \n            //Create a unique image name\n            const date = new Date().getTime();\n            const storageRef = ref(storage, `${displayName + date}`);\n      \n      \n            await uploadBytesResumable(storageRef, img).then(() => {\n              getDownloadURL(storageRef).then(async (downloadURL) => {\n                try {\n                  //create user on firestore\n                  await setDoc(doc(db, \"users\", displayName), {\n                    uid: uuid(),\n                    displayName,\n                    photoURL: downloadURL,\n                  });\n      \n                  await setDoc(doc(db, \"userChats\", displayName), {});\n                  await setDoc(doc(db, \"chats\", displayName), { messages: [] });\n                  navigate(\"/chats\");\n      \n                } catch (err) {\n                  console.log(err);\n                  setErr(true);\n                }\n              });\n            });\n      \n          } catch (err) {\n            setErr(true);\n            console.log(err);\n          }\n    }\n\n    return (\n        <>\n            <Button variant=\"danger\" onClick={handleShow} size=\"lg\">\n                Nuevo chat grupal\n            </Button>\n\n            <Modal show={show} onHide={handleClose}>\n                <Modal.Header closeButton className='bn39'>\n                    <Modal.Title>Añadir nuevo chat de grupo</Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <Form>\n                        <Form.Group className=\"mb-3\" controlId=\"formBasicEmail\">\n                            <Form.Label>Nombre del grupo:</Form.Label>\n                            <Form.Control type=\"text\" placeholder=\"Grupo #1...\" onChange={e => setName(e.target.value)}/>\n                            <Form.Text className=\"text-muted\">\n                                Los usuarios tendrán que buscar el nombre del grupo en el campo de texto para ingresar a él.\n                            </Form.Text>\n                        </Form.Group>\n\n                        <Form.Group className=\"mb-3\" controlId=\"formBasicPassword\">\n                            <Form.Label>Foto del grupo:</Form.Label>\n                            <Form.Control type=\"file\" onChange={e => setImg(e.target.files[0])} />\n                        </Form.Group>\n                        <Button variant=\"danger\" onClick={sendGroup}>\n                            Crear grupo\n                        </Button>\n                    </Form>\n                </Modal.Body>\n                <Modal.Footer>\n                </Modal.Footer>\n            </Modal>\n            <br></br>\n        </>\n    );\n};\n\nexport default GroupButton"],"mappings":"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"},"metadata":{},"sourceType":"module"}