{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Downloads\\\\PWII\\\\PWII-PROYECTOFINAL\\\\PWII-PROYECTOFINAL\\\\PWII\\\\pia-pwii\\\\src\\\\pages\\\\MiPerfil.jsx\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Navigation from '../Components/NavigationLayout';\nimport './Test.css';\nimport { db } from \"../firebase\";\nimport { v4 as uuid } from \"uuid\";\nimport { collection, query, where, getDocs, serverTimestamp, updateDoc, Timestamp } from \"firebase/firestore\";\nimport { arrayUnion, arrayRemove, getDoc } from \"firebase/firestore\";\nimport { doc, onSnapshot } from \"firebase/firestore\";\nimport { ChatConext } from \"../Context/ChatContext\";\nimport { useState, useEffect } from \"react\";\nimport { ref, uploadBytes, getDownloadURL, listAll, list } from \"firebase/storage\";\nimport { storage } from \"../firebase\";\nimport { v4 } from \"uuid\";\nimport { useContext } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MiPerfil = () => {\n  _s();\n\n  const [imageUpload, setImageUpload] = useState(null);\n  const [imageUrls, setImageUrls] = useState([]);\n  const {\n    data\n  } = useContext(ChatConext);\n  const imagesListRef = ref(storage, \"images/\");\n\n  const uploadFile = () => {\n    if (imageUpload == null) return;\n    const imageRef = ref(storage, `images/${imageUpload.name + v4()}`);\n    uploadBytes(imageRef, imageUpload).then(snapshot => {\n      getDownloadURL(snapshot.ref).then(url => {\n        setImageUrls(prev => [...prev, url]);\n      });\n    });\n  };\n\n  useEffect(() => {\n    listAll(imagesListRef).then(response => {\n      response.items.forEach(item => {\n        getDownloadURL(item).then(url => {\n          setImageUrls(prev => [...prev, url]);\n        });\n      });\n    });\n  }, []);\n  let urlImDesc;\n\n  const guardarProductos = async e => {\n    e.preventDefault();\n    const nombre = e.target.nombre.value;\n    const precio = e.target.precio.value;\n    const newProduct = {\n      nombre: nombre,\n      precio: precio,\n      imagen: urlImDesc\n    };\n\n    try {\n      await updateDoc(doc(db, \"Productos\"), { ...newProduct\n      });\n    } catch (error) {\n      console.log(error);\n    }\n\n    e.target.nombre.value = '';\n    e.target.precio.value = '';\n    e.target.file.value = '';\n  };\n\n  uploadFile.on(error => {//TODO:Handle Error\n  }, () => {\n    getDownloadURL(uploadFile.snapshot.ref).then(async downloadURL => {\n      await updateDoc(doc(db, \"chats\", data.chatId), {\n        messages: arrayUnion({\n          id: uuid()\n        })\n      });\n    });\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Navigation, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card card-body\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-center\",\n          children: \"Agregar Productos\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 1\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Nombre: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 1\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              placeholder: \"Ingresa el nombre del producto\",\n              id: \"nombre\",\n              className: \"form-control mt-1\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 5\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 1\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Precio: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 1\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              placeholder: \"Ingresa el precio\",\n              id: \"precio\",\n              className: \"form-control mt-1\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 5\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 1\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Agregar Imagen: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 1\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            onChange: event => {\n              setImageUpload(event.target.files[0]);\n            },\n            className: \"form-control\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 1\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-primary mt-3 form-control\",\n            onClick: uploadFile,\n            children: \" Upload Image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 1\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 5\n    }, this), imageUrls.map(url => {\n      return /*#__PURE__*/_jsxDEV(\"img\", {\n        src: url\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 8\n      }, this);\n    })]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this);\n};\n\n_s(MiPerfil, \"2/c/4woFJ2CNJcBRyn/7kkWZWn0=\");\n\n_c = MiPerfil;\nexport default MiPerfil;\n/*\n\n <div>\n              <Navigation />\n              <Container> \n              <div className='card card-body'>\n          <h3 className='text-center'>Agregar Productos</h3>\n          <form /*onSubmit={uploadFile} >\n          <label>Nombre: </label>\n          <div className='form-group'>\n              <input type=\"text\" placeholder='Ingresa el nombre del producto' id='nombre' className='form-control mt-1' required />\n          </div>\n\n          <label>Precio: </label>\n          <div className='form-group'>\n              <input type=\"text\" placeholder='Ingresa el precio' id='precio' className='form-control mt-1' required />\n          </div>\n        <label>Agregar Imagen: </label>\n       \n        <input  type=\"file\" onChange={(event) => { setImageUpload(event.target.files[0]);  }}  className='form-control'/>\n        <button  className='btn btn-primary mt-3 form-control' onClick={uploadFile}> Guardar</button>\n        \n      </form>\n  </div>\n     \n          </Container>\n         {imageUrls.map((url) => {\n          return <img src={url} />;\n        })}\n          \n          </div>\n\n\n          <div className=\"App\">\n      <input\n        type=\"file\"\n        onChange={(event) => {\n          setImageUpload(event.target.files[0]);\n        }}\n      />\n      <button onClick={uploadFile}> Upload Image</button>\n      {imageUrls.map((url) => {\n        return <img src={url} />;\n      })}\n    </div>\n\n*/\n\nvar _c;\n\n$RefreshReg$(_c, \"MiPerfil\");","map":{"version":3,"names":["React","Container","Navigation","db","v4","uuid","collection","query","where","getDocs","serverTimestamp","updateDoc","Timestamp","arrayUnion","arrayRemove","getDoc","doc","onSnapshot","ChatConext","useState","useEffect","ref","uploadBytes","getDownloadURL","listAll","list","storage","useContext","MiPerfil","imageUpload","setImageUpload","imageUrls","setImageUrls","data","imagesListRef","uploadFile","imageRef","name","then","snapshot","url","prev","response","items","forEach","item","urlImDesc","guardarProductos","e","preventDefault","nombre","target","value","precio","newProduct","imagen","error","console","log","file","on","downloadURL","chatId","messages","id","event","files","map"],"sources":["C:/Users/User/Downloads/PWII/PWII-PROYECTOFINAL/PWII-PROYECTOFINAL/PWII/pia-pwii/src/pages/MiPerfil.jsx"],"sourcesContent":["import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Navigation from '../Components/NavigationLayout';\nimport './Test.css'\nimport { db } from \"../firebase\";\nimport { v4 as uuid } from \"uuid\";\nimport { collection, query, where, getDocs, serverTimestamp, updateDoc, Timestamp } from \"firebase/firestore\";\nimport { arrayUnion, arrayRemove, getDoc } from \"firebase/firestore\";\nimport { doc, onSnapshot } from \"firebase/firestore\";\nimport { ChatConext } from \"../Context/ChatContext\";\nimport { useState, useEffect } from \"react\";\nimport {ref, uploadBytes, getDownloadURL, listAll, list} from \"firebase/storage\";\nimport { storage } from \"../firebase\";\nimport { v4 } from \"uuid\";\nimport  { useContext} from \"react\";\nconst MiPerfil = () => {\n  const [imageUpload, setImageUpload] = useState(null);\n  const [imageUrls, setImageUrls] = useState([]);\n  const { data } = useContext(ChatConext);\n\n  const imagesListRef = ref(storage, \"images/\");\n  const uploadFile = () => {\n    if (imageUpload == null) return;\n    const imageRef = ref(storage, `images/${imageUpload.name + v4()}`);\n    uploadBytes(imageRef, imageUpload).then((snapshot) => {\n      getDownloadURL(snapshot.ref).then((url) => {\n        setImageUrls((prev) => [...prev, url]);\n      });\n    });\n  };\n\n  useEffect(() => {\n    listAll(imagesListRef).then((response) => {\n      response.items.forEach((item) => {\n        getDownloadURL(item).then((url) => {\n          setImageUrls((prev) => [...prev, url]);\n        });\n      });\n    });\n  }, []);\n\n  let urlImDesc;\n\n  const guardarProductos = async(e)=>{\n    e.preventDefault()\n    const nombre = e.target.nombre.value;\n    const precio = e.target.precio.value;\n\n    const newProduct = {\n      nombre: nombre,\n      precio: precio,\n      imagen: urlImDesc\n    }\n\n    try{\n      await updateDoc(doc(db, \"Productos\"), {\n          ...newProduct\n      })\n    } catch (error){\n       console.log(error);\n    }  \n\n    e.target.nombre.value='';\n    e.target.precio.value='';\n    e.target.file.value='';\n\n  }\n\n\n\n\n  uploadFile.on(\n    (error) => {\n        //TODO:Handle Error\n    },\n    () => {\n        getDownloadURL(uploadFile.snapshot.ref).then(async (downloadURL) => {\n            await updateDoc(doc(db, \"chats\", data.chatId), {\n                messages: arrayUnion({\n                    id: uuid(),\n                  \n                }),\n            });\n        });\n    }\n);\n\n\n\n\n\n\n\n\n\n\n\n  return (\n\n    <div>\n    <Navigation />\n    <Container> \n    <div className='card card-body'>\n<h3 className='text-center'>Agregar Productos</h3>\n<form /*onSubmit={uploadFile}*/ >\n<label>Nombre: </label>\n<div className='form-group'>\n    <input type=\"text\" placeholder='Ingresa el nombre del producto' id='nombre' className='form-control mt-1' required />\n</div>\n\n<label>Precio: </label>\n<div className='form-group'>\n    <input type=\"text\" placeholder='Ingresa el precio' id='precio' className='form-control mt-1' required />\n</div>\n<label>Agregar Imagen: </label>\n\n\n\n<input\n        type=\"file\"\n        onChange={(event) => {\n          setImageUpload(event.target.files[0]);\n        }}\n        className='form-control' />\n      <button  className='btn btn-primary mt-3 form-control'onClick={uploadFile}> Upload Image</button>\n\n\n\n   \n</form>\n</div>\n\n</Container>\n{imageUrls.map((url) => {\nreturn <img src={url} />;\n})}\n\n</div>\n\n\n    \n  );\n}\n\nexport default MiPerfil;\n/*\n\n <div>\n              <Navigation />\n              <Container> \n              <div className='card card-body'>\n          <h3 className='text-center'>Agregar Productos</h3>\n          <form /*onSubmit={uploadFile} >\n          <label>Nombre: </label>\n          <div className='form-group'>\n              <input type=\"text\" placeholder='Ingresa el nombre del producto' id='nombre' className='form-control mt-1' required />\n          </div>\n\n          <label>Precio: </label>\n          <div className='form-group'>\n              <input type=\"text\" placeholder='Ingresa el precio' id='precio' className='form-control mt-1' required />\n          </div>\n        <label>Agregar Imagen: </label>\n       \n        <input  type=\"file\" onChange={(event) => { setImageUpload(event.target.files[0]);  }}  className='form-control'/>\n        <button  className='btn btn-primary mt-3 form-control' onClick={uploadFile}> Guardar</button>\n        \n      </form>\n  </div>\n     \n          </Container>\n         {imageUrls.map((url) => {\n          return <img src={url} />;\n        })}\n          \n          </div>\n\n\n          <div className=\"App\">\n      <input\n        type=\"file\"\n        onChange={(event) => {\n          setImageUpload(event.target.files[0]);\n        }}\n      />\n      <button onClick={uploadFile}> Upload Image</button>\n      {imageUrls.map((url) => {\n        return <img src={url} />;\n      })}\n    </div>\n\n*/ "],"mappings":"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"},"metadata":{},"sourceType":"module"}