{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Downloads\\\\POI_Tims\\\\POI-PROYECTOFINAL\\\\POI-PROYECTOFINAL\\\\src\\\\Components\\\\MessagesT.jsx\",\n    _s = $RefreshSig$();\n\nimport { doc, onSnapshot } from \"firebase/firestore\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { ChatConext } from \"../Context/ChatContext\";\nimport { db } from \"../firebase\";\nimport Message from \"./MessageT\";\nimport MessageGroup from \"./MessageGroup\";\nimport \"../stilos.scss\";\nimport \"./MessagesT.css\";\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form'; //Bootstrap\n\nimport { v4 as uuid } from \"uuid\";\nimport { AuthConext } from '../Context/AuthContext';\nimport CryptoJS from 'crypto-js';\nimport { collection, query, where, getDocs, serverTimestamp, updateDoc, Timestamp } from \"firebase/firestore\";\nimport { arrayUnion, arrayRemove, getDoc } from \"firebase/firestore\";\nimport { getDownloadURL, ref, uploadBytesResumable } from \"firebase/storage\";\nimport { storage } from '../firebase';\nimport { useRef } from 'react';\nimport Cam from \"../img/cam.png\";\nimport Img from \"../img/img.png\";\nimport Send from \"../img/send.png\";\nimport Map from \"../img/mapa.png\";\nimport Attach from \"../img/attach.png\";\nimport { useCallback } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Messages = () => {\n  _s();\n\n  var _data$user;\n\n  //Manejar estado de encriptacion\n  const [encriptar, setEncriptar] = useState(false);\n\n  const toggleEncrypt = () => {\n    setEncriptar(!encriptar); // console.log(encriptar)\n  }; //Funciones para encriptar los mensajes\n\n\n  const cifrar = texto => {\n    if (encriptar) {\n      var textoCifrado = CryptoJS.AES.encrypt(texto, \"poi\").toString();\n      return textoCifrado;\n    } else {\n      return \"\";\n    }\n  };\n\n  const {\n    data\n  } = useContext(ChatConext);\n  const [err, setErr] = useState(false);\n  const [cifrado, setCifrado] = useState(false);\n  const [idGroup, setIdGroup] = useState(\"null\");\n  const [param, setParam] = useState(\"null\");\n  const [messages, setMessages] = useState([]);\n  const [messagesGroup, setMessagesGroup] = useState([]);\n  const [chatIsGroup, setIsGroup] = useState(false);\n  const {\n    currentUser\n  } = useContext(AuthConext);\n  useEffect(() => {\n    const unSub = onSnapshot(doc(db, \"chats\", data.chatId), doc => {\n      doc.exists() && setMessages(doc.data().messages);\n    });\n    return () => {\n      unSub();\n    };\n  }, [data.chatId]);\n  useEffect(() => {\n    const unSubGroup = onSnapshot(doc(db, \"chats\", idGroup), doc => {\n      doc.exists() && setMessagesGroup(doc.data().messages);\n    });\n    return () => {\n      unSubGroup();\n    };\n  }, [idGroup]); // DIVISION PARA TRAER MSG DE UN GRUPO\n\n  const handlerGroup = async g => {\n    try {\n      console.log(\"chats/\" + g);\n      const docRef = doc(db, \"chats\", g);\n      const docSnap = await getDoc(docRef);\n\n      if (docSnap.exists()) {\n        setIsGroup(true);\n        setIdGroup(g);\n      } else {\n        setIsGroup(false);\n        setIdGroup(\"null\");\n        setMessagesGroup([]);\n      }\n    } catch (err) {// console.log(\"no ps f\")\n    }\n  }; //DIVISION PARA EL ENVIO DE MENSAJES\n\n\n  const [text, setText] = useState(\"\");\n  const [img, setImg] = useState(null);\n\n  const handleSendMessageLocation = async () => {\n    navigator.geolocation.getCurrentPosition(showPosition, showError);\n\n    function getLocation() {\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(showPosition);\n      } else {\n        alert(\"Geolocation is not supported by this browser.\");\n      }\n    }\n\n    getLocation();\n\n    function showPosition(position) {\n      var str = \"https://www.google.com/maps/place/\" + position.coords.latitude + \",\" + position.coords.longitude;\n      document.getElementById(\"mensaje\").value = str;\n    }\n\n    function showError(error) {\n      console.log('getCurrentPosition returned error', error);\n    }\n  };\n\n  const handleSendMessage = async () => {\n    if (chatIsGroup) {\n      //console.log(\"es grupo\")\n      if (img) {\n        const storageRef = ref(storage, uuid());\n        const uploadTask = uploadBytesResumable(storageRef, img);\n        uploadTask.on(error => {//TODO:Handle Error\n        }, () => {\n          getDownloadURL(uploadTask.snapshot.ref).then(async downloadURL => {\n            await updateDoc(doc(db, \"chats\", idGroup), {\n              messages: arrayUnion({\n                id: uuid(),\n                encriptado: cifrar(text),\n                text: text,\n                senderId: currentUser.uid,\n                date: Timestamp.now(),\n                img: downloadURL,\n                displayName: currentUser.displayName,\n                photoURL: currentUser.photoURL\n              })\n            });\n          });\n        });\n      } else {\n        await updateDoc(doc(db, \"chats\", idGroup), {\n          messages: arrayUnion({\n            id: uuid(),\n            encriptado: cifrar(text),\n            text: text,\n            senderId: currentUser.uid,\n            date: Timestamp.now(),\n            displayName: currentUser.displayName,\n            photoURL: currentUser.photoURL\n          })\n        });\n      }\n    } else {\n      if (img) {\n        const storageRef = ref(storage, uuid());\n        const uploadTask = uploadBytesResumable(storageRef, img);\n        uploadTask.on(error => {//TODO:Handle Error\n        }, () => {\n          getDownloadURL(uploadTask.snapshot.ref).then(async downloadURL => {\n            await updateDoc(doc(db, \"chats\", data.chatId), {\n              messages: arrayUnion({\n                id: uuid(),\n                encriptado: cifrar(text),\n                text: text,\n                senderId: currentUser.uid,\n                date: Timestamp.now(),\n                displayName: currentUser.displayName,\n                img: downloadURL\n              })\n            });\n          });\n        });\n      } else {\n        await updateDoc(doc(db, \"chats\", data.chatId), {\n          messages: arrayUnion({\n            id: uuid(),\n            encriptado: cifrar(text),\n            text: text,\n            senderId: currentUser.uid,\n            date: Timestamp.now(),\n            displayName: currentUser.displayName\n          })\n        });\n      }\n\n      await updateDoc(doc(db, \"userChats\", currentUser.uid), {\n        [data.chatId + \".lastMessage\"]: {\n          text\n        },\n        [data.chatId + \".date\"]: serverTimestamp()\n      });\n      await updateDoc(doc(db, \"userChats\", data.user.uid), {\n        [data.chatId + \".lastMessage\"]: {\n          text\n        },\n        [data.chatId + \".date\"]: serverTimestamp()\n      });\n    }\n\n    setIsGroup(false);\n    setIdGroup(\"null\");\n    setMessagesGroup([]); //console.log(\"ya lo puse falso\")\n    //setText(\"\");\n    //setImg(null);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: handlerGroup((_data$user = data.user) === null || _data$user === void 0 ? void 0 : _data$user.displayName),\n      children: \" \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 8\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"messagesT\",\n      children: [messages.map(m => /*#__PURE__*/_jsxDEV(Message, {\n        message: m\n      }, m.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 11\n      }, this)), messagesGroup.map(m => /*#__PURE__*/_jsxDEV(MessageGroup, {\n        message: m\n      }, m.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inputT\",\n      children: [/*#__PURE__*/_jsxDEV(Form.Control, {\n        id: \"mensaje\",\n        className: \"me-auto\",\n        placeholder: \"Mensaje a enviar...\",\n        onChange: e => setText(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sendT\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vr\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"primary\",\n          onClick: handleSendMessageLocation,\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: Map,\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 73\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Form, {\n          children: /*#__PURE__*/_jsxDEV(Form.Check, {\n            onClick: toggleEncrypt,\n            type: \"switch\",\n            id: \"custom-switch\",\n            label: \"Cifrar \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          src: Img,\n          type: \"file\",\n          onChange: e => setImg(e.target.files[0])\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"http://localhost:3030/e0f3826b-dc09-4d2b-9b33-eda560cfb835\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: Cam\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 79\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 10\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"danger\",\n          onClick: handleSendMessage,\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: Send,\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 64\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 263,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Messages, \"HLoqNCKN/NNy/rfa96XFyHjyFe0=\");\n\n_c = Messages;\nexport default Messages;\n\nvar _c;\n\n$RefreshReg$(_c, \"Messages\");","map":{"version":3,"names":["doc","onSnapshot","React","useContext","useEffect","useState","ChatConext","db","Message","MessageGroup","Button","Form","v4","uuid","AuthConext","CryptoJS","collection","query","where","getDocs","serverTimestamp","updateDoc","Timestamp","arrayUnion","arrayRemove","getDoc","getDownloadURL","ref","uploadBytesResumable","storage","useRef","Cam","Img","Send","Map","Attach","useCallback","Messages","encriptar","setEncriptar","toggleEncrypt","cifrar","texto","textoCifrado","AES","encrypt","toString","data","err","setErr","cifrado","setCifrado","idGroup","setIdGroup","param","setParam","messages","setMessages","messagesGroup","setMessagesGroup","chatIsGroup","setIsGroup","currentUser","unSub","chatId","exists","unSubGroup","handlerGroup","g","console","log","docRef","docSnap","text","setText","img","setImg","handleSendMessageLocation","navigator","geolocation","getCurrentPosition","showPosition","showError","getLocation","alert","position","str","coords","latitude","longitude","document","getElementById","value","error","handleSendMessage","storageRef","uploadTask","on","snapshot","then","downloadURL","id","encriptado","senderId","uid","date","now","displayName","photoURL","user","map","m","e","target","files"],"sources":["C:/Users/User/Downloads/POI_Tims/POI-PROYECTOFINAL/POI-PROYECTOFINAL/src/Components/MessagesT.jsx"],"sourcesContent":["import { doc, onSnapshot } from \"firebase/firestore\";\nimport React, { useContext, useEffect, useState} from \"react\";\nimport { ChatConext } from \"../Context/ChatContext\";\nimport { db } from \"../firebase\";\nimport Message from \"./MessageT\";\nimport MessageGroup from \"./MessageGroup\";\nimport \"../stilos.scss\";\nimport \"./MessagesT.css\";\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\n\n//Bootstrap\nimport { v4 as uuid } from \"uuid\";\nimport { AuthConext } from '../Context/AuthContext';\nimport CryptoJS from 'crypto-js';\n\nimport { collection, query, where, getDocs, serverTimestamp, updateDoc, Timestamp } from \"firebase/firestore\";\nimport { arrayUnion, arrayRemove, getDoc } from \"firebase/firestore\";\nimport { getDownloadURL, ref, uploadBytesResumable } from \"firebase/storage\";\nimport {storage } from '../firebase';\nimport { useRef } from 'react';\nimport Cam from \"../img/cam.png\";\nimport Img from \"../img/img.png\";\nimport Send from \"../img/send.png\"\nimport Map from \"../img/mapa.png\"\nimport Attach from \"../img/attach.png\";\nimport { useCallback } from \"react\";\n\n\n\nconst Messages = () => {\n\n  //Manejar estado de encriptacion\n  const [encriptar, setEncriptar] = useState(false);\n\n  const toggleEncrypt = () => {\n      setEncriptar(!encriptar)\n     // console.log(encriptar)\n    \n  }\n\n  //Funciones para encriptar los mensajes\n  const cifrar = (texto) => {\n      if (encriptar) {\n          var textoCifrado = CryptoJS.AES.encrypt(texto, \"poi\").toString();\n          return textoCifrado;\n      } else {\n          return \"\";\n      }\n  }\n\n  \n\n  const { data } = useContext(ChatConext);\n  const [err, setErr] = useState(false);\n  const [cifrado, setCifrado] = useState(false);\n\n  const [idGroup, setIdGroup] = useState(\"null\");\n  const [param, setParam] = useState(\"null\");\n  const [messages, setMessages] = useState([]);\n  const [messagesGroup, setMessagesGroup] = useState([]);\n\n  const [chatIsGroup, setIsGroup] = useState(false);\n\n  const { currentUser } = useContext(AuthConext);\n\n  useEffect(() => {\n      const unSub = onSnapshot(doc(db, \"chats\", data.chatId), (doc) => {\n          doc.exists() && setMessages(doc.data().messages)\n      })\n      return () => {\n\n          unSub()\n      }\n  }, [data.chatId]);\n\n  useEffect(() => {\n\n  \n    const unSubGroup = onSnapshot(doc(db, \"chats\", idGroup), (doc) => {\n        doc.exists() && setMessagesGroup(doc.data().messages)\n\n    })\n    return () => {\n        unSubGroup()\n    }\n  }, [idGroup]);\n  \n  // DIVISION PARA TRAER MSG DE UN GRUPO\n  const handlerGroup = async (g) => {\n    try {\n      console.log(\"chats/\" + g)\n      const docRef = doc(db, \"chats\", g);\n      const docSnap = await getDoc(docRef);\n\n      if (docSnap.exists()) {\n        setIsGroup(true);\n        setIdGroup(g);\n      } else {\n       \n        setIsGroup(false);\n        setIdGroup(\"null\");\n        setMessagesGroup([])\n      }\n    } catch (err) {\n     // console.log(\"no ps f\")\n    }\n    \n  }\n\n\n\n  //DIVISION PARA EL ENVIO DE MENSAJES\n  const [text, setText] = useState(\"\");\n  const [img, setImg] = useState(null);\n\n  const handleSendMessageLocation = async () => {\n      navigator.geolocation.getCurrentPosition(showPosition, showError);\n      \n      function getLocation(){\n          if (navigator.geolocation){\n             navigator.geolocation.getCurrentPosition(showPosition);\n            }else{\n               alert(\"Geolocation is not supported by this browser.\");\n            }\n          \n        }\n           \n        getLocation()\n        \n         function showPosition(position) {\n              \n           \n \n              \n              var str=\"https://www.google.com/maps/place/\" + position.coords.latitude + \",\" + position.coords.longitude\n\n              document.getElementById(\"mensaje\").value=str\n          \n            }\n\n          function showError( error ) {\n            console.log( 'getCurrentPosition returned error', error);\n          }\n  \n        }\n  \n        const handleSendMessage = async () => {\n\n        if (chatIsGroup) {\n        //console.log(\"es grupo\")\n        if (img) {\n            const storageRef = ref(storage, uuid());\n\n            const uploadTask = uploadBytesResumable(storageRef, img);\n\n            uploadTask.on(\n                (error) => {\n                    //TODO:Handle Error\n                },\n                () => {\n                    getDownloadURL(uploadTask.snapshot.ref).then(async (downloadURL) => {\n                        await updateDoc(doc(db, \"chats\", idGroup), {\n                            messages: arrayUnion({\n                                id: uuid(),\n                                encriptado:  cifrar(text), \n                                text: text,\n                                senderId: currentUser.uid,\n                                date: Timestamp.now(),\n                                img: downloadURL,\n                                displayName: currentUser.displayName,\n                                photoURL: currentUser.photoURL,\n                            }),\n                        });\n                    });\n                }\n            );\n\n        } else {\n            await updateDoc(doc(db, \"chats\", idGroup), {\n                messages: arrayUnion({\n                    id: uuid(),\n                    encriptado:  cifrar(text), \n                    text: text,\n                    senderId: currentUser.uid,\n                    date: Timestamp.now(),\n                    displayName: currentUser.displayName,\n                    photoURL: currentUser.photoURL,\n                })\n            })\n        }\n    } else {\n        if (img) {\n            const storageRef = ref(storage, uuid());\n\n            const uploadTask = uploadBytesResumable(storageRef, img);\n\n            uploadTask.on(\n                (error) => {\n                    //TODO:Handle Error\n                },\n                () => {\n                    getDownloadURL(uploadTask.snapshot.ref).then(async (downloadURL) => {\n                        await updateDoc(doc(db, \"chats\", data.chatId), {\n                            messages: arrayUnion({\n                                id: uuid(),\n                                encriptado:  cifrar(text), \n                                text: text,\n                                senderId: currentUser.uid,\n                                date: Timestamp.now(),\n                                displayName: currentUser.displayName,\n                                img: downloadURL,\n                            }),\n                        });\n                    });\n                }\n            );\n\n        } else {\n            await updateDoc(doc(db, \"chats\", data.chatId), {\n                messages: arrayUnion({\n                    id: uuid(),\n                    encriptado:  cifrar(text), \n                    text: text,\n                    senderId: currentUser.uid,\n                    date: Timestamp.now(),\n                    displayName: currentUser.displayName,\n                })\n            })\n        }\n\n        \n\n        await updateDoc(doc(db, \"userChats\", currentUser.uid), {\n            [data.chatId + \".lastMessage\"]: {\n                text,\n            },\n            [data.chatId + \".date\"]: serverTimestamp(),\n        });\n\n        await updateDoc(doc(db, \"userChats\", data.user.uid), {\n            [data.chatId + \".lastMessage\"]: {\n                text,\n            },\n            [data.chatId + \".date\"]: serverTimestamp(),\n        });\n    }\n\n\n    setIsGroup(false);\n    setIdGroup(\"null\")\n    setMessagesGroup([])\n    //console.log(\"ya lo puse falso\")\n    //setText(\"\");\n    //setImg(null);\n};\n\n  \n\n\n\n  return (\n    <section>\n      { /*onChange={(g) => handlerGroup(data.user?.displayName, g)}*/}\n      \n      {<div onClick={handlerGroup(data.user?.displayName)}> </div>}\n      <div className=\"messagesT\">\n      \n\n        {messages.map((m) => (\n          <Message message={m} key={m.id}  />\n          \n        ))}\n        {messagesGroup.map((m) => (\n          <MessageGroup message={m} key={m.id}  />\n        ))}\n      </div>\n   \n      <div className=\"inputT\">\n        <Form.Control id=\"mensaje\" className=\"me-auto\" placeholder=\"Mensaje a enviar...\" onChange={e => setText(e.target.value)} />\n        \n        <div className=\"sendT\"> \n          {/* <img src={Attach} alt=\"\" /> \n          <input \n            type=\"file\"\n            style={{ display: \"none\" }}\n            id=\"file\"\n            onChange={(e) => setImg(e.target.files[0])}\n          />*/}\n          <div className=\"vr\" />\n          <Button variant=\"primary\" onClick={handleSendMessageLocation}><img src={Map} alt=\"\" /> </Button>\n          {/* <label htmlFor=\"fileInputM\"> */}\n            {/* <img id=\"iconM\" src={Attach} /> */}\n          {/* </label> */}\n          {/* <input id=\"fileInputM\" type=\"file\" onChange={e => setImg(e.target.files[0])}></input> */}\n          <Form>\n            <Form.Check onClick={toggleEncrypt}\n                type=\"switch\"\n                id=\"custom-switch\"\n                label=\"Cifrar \"\n            />\n          </Form>\n          \n          <Form.Control  src={Img} type=\"file\" onChange={e => setImg(e.target.files[0])}>\n            \n         </Form.Control>\n            \n            \n        \n         \n       \n         <a href=\"http://localhost:3030/e0f3826b-dc09-4d2b-9b33-eda560cfb835\"><img src={Cam} /></a>\n          <Button variant=\"danger\" onClick={handleSendMessage}><img src={Send} alt=\"\" /> </Button>\n          \n        </div>\n      </div>\n  </section>\n\n  );\n};\n\nexport default Messages;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}